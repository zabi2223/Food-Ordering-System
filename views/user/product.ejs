<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Burger King</title>
  <link rel="stylesheet" href="/stylesheet/user-style.css" />
</head>
<body>

  <!-- Navbar -->
  <header class="navbar">
    <div class="logo">Burger King</div>
    <nav class="nav-links">
      <a href="/user">Home</a>
      <a href="/user/product" class="active">Products</a>
      <a href="/user/about">About</a>
      <a href="/user/cart"><span class="cart-icon">ðŸ›’</span></a>
      <% if (user) { %> <!-- If user is logged in -->
        <img class="profile-icon" src="/images/icon.png" alt="profile" id="profile-icon" />

        <div class="dropdown-menu" id="dropdown-menu">
          <ul>
            <li><a href="/user/profile">Profile</a></li>
            <li><a href="/user/logout">Logout</a></li>
          </ul>
        </div>
        
      <% } else { %> <!-- If user is not logged in -->
        <a href="/user/login" class="login-icon">
          <img src="/images/login.png" alt="login" />
        </a>
      <% } %>
    </nav>
  </header>
  <section class="hero">

  <!-- Product Section -->
  <section class="product-section">
      <h1>Our <span class="highlight">Menu</span></h1>
      <% if (products.length === 0) { %>
        <p>No product found in the database.</p>
      <% } else { %>
          <div class="product-container">
      <div class="product-grid">
        <% products.forEach(product => { 
     const isInCart = cartItems && cartItems.some(item => item.productId.toString() === product._id.toString());
%>
  <form action="/user/product/add" method="POST">
    <div class="product-card">
      <img src="data:<%= product.imageType %>;base64,<%= product.image %>" alt="<%= product.name %>">
      <h3><%= product.name %></h3>
      <p><%= product.description %></p>
      <span class="price">Price: <%= product.price %></span>
      <input type="hidden" name="name" value="<%= product.name %>">
      <input type="hidden" name="price" value="<%= product.price %>">
      <input type="hidden" name="productId" value="<%= product._id %>">
      <div class="order-line">
        <label for="quantity-<%= product._id %>">Quantity:</label>
        <input type="number" id="quantity-<%= product._id %>" name="quantity" min="1" value="1" class="quantity-box"
          <%= isInCart ? "disabled" : "" %> />
        <button class="btn-order" type="submit" <%= isInCart ? "disabled" : "" %>>
          <%= isInCart ? "Added to Cart" : "Add to Cart" %>
        </button>
      </div>
    </div>
  </form>
<% }); %>

      <% } %>
    </div>
  </div>
  </section>
</section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div>
        <h1 style="color: #ff6347; letter-spacing: 2px; margin-top: 20px;">Burger King</h1>
        <p>We deliver happiness in the form of Burger!</p>
      </div>
      <div>
        <h4>Quick Links</h4>
        <ul>
          <li><a href="/user">Home</a></li>
          <li><a href="/user/product">Products</a></li>
          <li><a href="/user/about">About</a></li>
        </ul>
      </div>
      <div>
        <h4>Contact</h4>
        <p>Email: support@BurgerKing.com</p>
        <p>Phone: +123 456 7890</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Burger King. All rights reserved.</p>
    </div>
  </footer>

  <% if (message) { %>
    <div id="success-message" class="alert">
      <%= message %>
    </div>
  <% } %>

  <script src="/javascript/scripts.js"></script>
</body>
</html>
